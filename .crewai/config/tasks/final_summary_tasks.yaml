synthesize_summary:
  description: |
    EXECUTE EXACTLY 5 TOOL CALLS IN THIS ORDER:

    TOOL CALL 1: WorkspaceTool(operation="read", filename="ci_summary.json", content="")
    Extract: status, summary, critical_errors, warnings

    TOOL CALL 2: WorkspaceTool(operation="read", filename="quick_review.json", content="")
    Extract: critical, warnings, info arrays

    TOOL CALL 3: WorkspaceTool(operation="read", filename="router_decision.json", content="")
    Extract: suggestions array

    TOOL CALL 4: WorkspaceTool(operation="exists", filename="full_review.json", content="")
    If exists, make TOOL CALL 5, else skip

    TOOL CALL 5 (conditional): WorkspaceTool(operation="read", filename="full_review.json", content="")

    TOOL CALL 6 (final): WorkspaceTool(operation="write", filename="final_summary.md", content="...markdown...")

    Required markdown for TOOL CALL 6:
    ```markdown
    ## ‚ö†Ô∏è Review Summary
    PR #[pr_number] | Commit: [sha] | Repository: [repository]

    ### ‚úÖ CI Analysis
    Status: [from ci_summary.json]
    Summary: [from ci_summary.json]

    <details>
    <summary><b>üîç CI Issues</b></summary>

    **Critical**: [list each from critical_errors]
    **Warnings**: [list each from warnings]
    </details>

    ### ‚ö° Quick Review
    Findings: [N] critical, [M] warnings, [K] info

    <details open>
    <summary><b>üî¥ Critical ([count])</b></summary>

    [Iterate critical array: each item on new line with title, file:line, description, fix]
    </details>

    <details>
    <summary><b>üü° Warnings ([count])</b></summary>

    [Iterate warnings array]
    </details>

    <details>
    <summary><b>üîµ Info ([count])</b></summary>

    [Iterate info array]
    </details>

    ### üîç Full Review
    [If full_review.json exists, show high-severity findings; else "Did not run"]

    ### üí° Router Suggestions
    [List each suggestion from router_decision.json]

    ---
    *ü§ñ Generated by CrewAI | [timestamp]*
    ```

    RULES:
    - Make ALL tool calls BEFORE returning text
    - DO NOT explain what you will do
    - DO NOT return text between tool calls
    - Iterate through EVERY item in arrays (don't summarize)
    - Minimum 1000 characters in final markdown

  expected_output: |
    Verify:
    1. Read 3-4 JSON files (ci, quick, router, optionally full)
    2. Wrote final_summary.md with >1000 characters

    Return: "Summary complete: [N] findings in final_summary.md"
