synthesize_summary:
  description: >
    YOU MUST synthesize all review outputs into comprehensive GitHub markdown
    with ALL findings in collapsible HTML <details> sections.

    **CRITICAL**: This is NOT a summary task. You must show EVERY finding with
    full details. DO NOT abbreviate or skip findings.

    **EXECUTION STEPS** (follow exactly):

    1. **Read CI Summary**:
       ```
       WorkspaceTool(operation="read", filename="ci_summary.json", content="")
       ```
       - Extract `critical_errors` array (show ALL errors, not count)
       - Extract `warnings` array (show ALL warnings)
       - Extract `summary`, `status`, `checks_performed`
       - If file missing/empty: note "CI analysis not available"

    2. **Read Quick Review** (MOST IMPORTANT):
       ```
       WorkspaceTool(operation="read", filename="quick_review.json", content="")
       ```
       - Extract arrays: `critical`, `warnings`, `info`
       - **YOU MUST iterate through EVERY item** in each array
       - For EACH item extract: `title`, `file`, `line`, `description`,
    `fix_suggestion`
       - Count totals but also SHOW each finding
       - If file missing/empty: note "Quick review not available"

    3. **Read Full Review** (if exists):
       ```
       WorkspaceTool(operation="read", filename="full_review.json", content="")
       ```
       - Extract high/critical severity findings only
       - If missing: note "Did not run"

    4. **Read Router Decision**:
       ```
       WorkspaceTool(operation="read", filename="router_decision.json",
    content="")
       ```
       - Extract `suggestions` array

    5. **Write Complete Markdown**:
       ```
       WorkspaceTool(operation="write", filename="final_summary.md",
    content="<markdown_here>")
       ```

    **OUTPUT FORMAT REQUIREMENTS**:

    Use this EXACT structure with actual data from the JSON files:

    ```markdown
    ## âš ï¸ Review Summary

    Review completed for PR with multiple workflows executed.

    **Commit**: Use actual commit SHA from data
    **Repository**: Use actual repository name
    **Workflows**: List actual workflows that ran
    **Timestamp**: Use actual timestamp

    ---

    ### âœ… CI Analysis
    **Status**: Use actual status emoji and text
    **Summary**: Use actual summary text from CI data

    <details>
    <summary><b>ğŸ” View CI Issues</b></summary>

    **Critical Errors**:
    1. **Error Type**: Error message here
       - ğŸ’¡ **Fix**: Fix suggestion here

    **Warnings**:
    1. Warning message here

    </details>

    ---

    ### âš¡ Quick Review
    **Status**: Use actual status from JSON
    **Summary**: Use actual summary text from JSON

    **Findings**:
    - ğŸ”´ COUNT critical issue(s) - use actual count
    - ğŸŸ¡ COUNT warning(s) - use actual count
    - ğŸ”µ COUNT suggestion(s) - use actual count

    <details open>
    <summary><b>ğŸ”´ Critical Issues (COUNT)</b></summary>

    - ğŸ”´ **Issue Title Here** `file/path.py:123`
      - Issue description here
      - ğŸ’¡ **Fix**: Fix suggestion here

    - ğŸ”´ **Next Issue Title**
      - Description
      - ğŸ’¡ **Fix**: Fix suggestion

    (Continue for ALL critical issues)

    </details>

    <details>
    <summary><b>ğŸŸ¡ Warnings (COUNT)</b></summary>

    - ğŸŸ¡ **Warning Title** `file/path.py:45`
      - Warning description
      - ğŸ’¡ **Fix**: Fix suggestion

    (Continue for ALL warnings)

    </details>

    <details>
    <summary><b>ğŸ”µ Suggestions (COUNT)</b></summary>

    - ğŸ”µ **Suggestion Title** `file/path.py:67`
      - Suggestion description
      - ğŸ’¡ **Fix**: Fix suggestion

    (Continue for ALL suggestions)

    </details>

    ---

    ### ğŸ” Full Technical Review
    Status: Show "Completed" or "Did not run"

    (If ran, show critical findings with same format)

    ---

    ### ğŸ’¡ Router Suggestions

    - Actual suggestion 1 from router
    - Actual suggestion 2 from router

    ---

    *ğŸ¤– Generated by CrewAI Router System | â±ï¸ Use actual timestamp*
    ```

    **VALIDATION BEFORE WRITING**:
    âœ“ Counted `critical` array length from quick_review.json
    âœ“ Counted `warnings` array length
    âœ“ Counted `info` array length
    âœ“ Iterated through EACH item in EACH array
    âœ“ Formatted each finding with title, file:line, description, fix
    âœ“ Used `<details open>` for critical (expanded)
    âœ“ Used `<details>` for warnings/suggestions (collapsed)
    âœ“ Replaced ALL placeholders with actual data from JSON files
    âœ“ Final markdown is 1500+ characters (comprehensive)

    **COMMON MISTAKES TO AVOID**:
    âŒ Writing "5 critical issues found" without listing them
    âŒ Using placeholders like "show all critical issues" instead of actual list
    âŒ Summarizing findings instead of showing each one
    âŒ Forgetting to call WorkspaceTool("write", "final_summary.md", ...)
    âŒ Writing markdown less than 1000 characters (means you skipped findings)

    **REMEMBER**: Your job is to format and display data, not summarize it. Read
    the JSON files and present EVERY finding in proper markdown format.

  expected_output: >
    Comprehensive GitHub-flavored markdown file saved as final_summary.md with
    minimum 1500 characters. Must contain ALL findings from quick_review.json
    displayed in collapsible <details> sections with title, file path, line
    number, description, and fix suggestion for EACH finding. Critical issues
    expanded by default, warnings/suggestions collapsed.
