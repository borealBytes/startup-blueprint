quick_code_review:
  description: >
    **CRITICAL TASK**: Perform fast code quality review AND write findings to
    quick_review.json using WorkspaceTool.

    **YOU MUST COMPLETE BOTH STEPS**: 1. Analyze the code changes 2. **WRITE the
    output to quick_review.json using WorkspaceTool**

    **INPUTS AVAILABLE**: - diff.txt (full PR diff) - commits.json (commit
    history) - diff.json (PR metadata)

    **STEP 1: Read and Analyze**

    1. **Read PR diff** using WorkspaceTool:
       ```
       WorkspaceTool(operation="read", filename="diff.txt", content="")
       ```
       Parse the unified diff format to extract file changes

    2. **Analyze each changed file** for:

       **Code Quality**:
       - Overly complex logic (nested loops, long methods)
       - Magic numbers/strings without constants
       - Duplicate code patterns
       - Missing error handling
       - Poor naming conventions

       **Best Practices**:
       - Missing documentation for public APIs
       - Hardcoded credentials or secrets
       - Console.log/print statements left in code
       - TODO/FIXME comments without tracking
       - Missing input validation

       **Performance Red Flags**:
       - N+1 query patterns
       - Unnecessary loops or iterations
       - Missing database indexes
       - Inefficient data structures

       **Security Concerns**:
       - SQL injection vulnerabilities
       - Unvalidated user input
       - Exposed sensitive data
       - Missing authentication checks

    3. **Categorize findings** by severity:
       - ðŸ”´ **CRITICAL**: Security vulnerabilities, data loss risks, breaking
    changes
       - ðŸŸ¡ **WARNING**: Code quality issues, missing docs, potential bugs
       - ðŸ”µ **INFO**: Style suggestions, minor improvements, best practices

    **STEP 2: WRITE OUTPUT FILE (MANDATORY)**

    After analyzing, you **MUST** call WorkspaceTool to write your findings:

    ``` WorkspaceTool(
      operation="write",
      filename="quick_review.json",
      content={
        "status": "warning",
        "passed": false,
        "summary": "Found 2 critical issues and 5 warnings",
        "critical": [
          {
            "title": "SQL Injection Vulnerability",
            "file": "api/users.py",
            "line": "45",
            "description": "User input concatenated directly into SQL query
    without sanitization",
            "fix_suggestion": "Use parameterized queries or ORM instead of
    string concatenation"
          }
        ],
        "warnings": [...],
        "info": [...],
        "files_reviewed": 5,
        "total_findings": 8
      }
    ) ```

    **IF NO ISSUES FOUND**, still write the file: ``` WorkspaceTool(
      operation="write",
      filename="quick_review.json",
      content={
        "status": "success",
        "passed": true,
        "summary": "No issues found",
        "critical": [],
        "warnings": [],
        "info": [],
        "files_reviewed": 5,
        "total_findings": 0
      }
    ) ```

    **OUTPUT FORMAT REQUIREMENTS**: - status: "success", "warning", or
    "critical" - passed: true/false - summary: Brief text summary - critical:
    Array of critical issues (may be empty) - warnings: Array of warnings (may
    be empty) - info: Array of suggestions (may be empty) - files_reviewed:
    Number of files analyzed - total_findings: Total count of all findings

    **Each finding object must have**: - title: Short title - file: File path -
    line: Line number (string) - description: What's wrong - fix_suggestion: How
    to fix it

    **VALIDATION BEFORE COMPLETION**: - [ ] Did you call WorkspaceTool with
    operation="write"? - [ ] Did you set filename="quick_review.json"? - [ ]
    Does content have all required fields? - [ ] Are arrays (critical, warnings,
    info) present even if empty?

    **IMPORTANT**: - Focus on NEW/CHANGED code only (lines starting with `+` in
    diff) - Ignore formatting/style if CI handles it - Provide specific line
    numbers from the diff - Every finding MUST have a concrete fix suggestion -
    Be concise - this is a "quick" review - **YOU MUST WRITE THE FILE - do not
    just return JSON as text**

  expected_output: >
    Confirmation that quick_review.json has been written to workspace using
    WorkspaceTool. The file must contain a JSON object with categorized findings
    (critical/warning/info) including file paths, line numbers, issue
    descriptions, and specific fix suggestions.
