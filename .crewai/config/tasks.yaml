analyze_commit_changes:
  description: >
    Analyze commit {commit_sha} in repository {repository} (PR #{pr_number}).

    Focus on: diff content (lines added/removed), new files, removed files.
    Evaluate: code style, readability, test coverage, documentation. Assess
    commit message: does it clearly explain what and why?

    Use the CommitDiffTool with commit_sha="{commit_sha}" and
    repository="{repository}". Provide specific line references from the diff.
  expected_output: >
    A structured report with: - Commit message assessment (clear/unclear,
    follows conventions) - Files changed breakdown (new, modified, removed) -
    Code quality issues by file (severity: high/medium/low) - Missing tests for
    new functionality - Documentation gaps - Specific recommendations with line
    numbers
  agent: code_quality_reviewer

security_performance_review:
  description: >
    Review commit {commit_sha} in repository {repository} for security and
    performance issues.

    Focus on lines added (new attack surface) and removed (breaking changes).
    Check for: SQL injection, XSS, auth bypasses, hardcoded secrets, N+1
    queries, memory leaks, inefficient algorithms.

    Use the CommitDiffTool with commit_sha="{commit_sha}" and
    repository="{repository}". Flag CRITICAL issues that block merge.
  expected_output: >
    A report with: - Security vulnerabilities (CRITICAL/HIGH/MEDIUM) with CVE
    references - Performance bottlenecks with estimated impact - Hardcoded
    secrets or credentials (immediate block) - Remediation steps for each issue
  agent: security_performance_analyst

find_related_files:
  description: >
    Identify files functionally or logically related to changed files in commit
    {commit_sha} of repository {repository}, even if NOT modified in this
    commit.

    Analyze: imports, dependencies, shared patterns, architectural layers. This
    finds hidden impacts not visible in the commit diff.

    Use RelatedFilesTool to discover related files based on the changed files
    from the commit.
  expected_output: >
    A list of related files with: - File path - Relationship type (imports,
    imported by, shared dependency, pattern) - Relatedness score (0-100) - Why
    it's related and potential impact
  agent: architecture_impact_analyst

analyze_related_files:
  description: >
    Analyze the related files identified in the previous task for repository
    {repository}. Assess potential impacts of commit {commit_sha}'s changes on
    those files.

    Consider: breaking changes, interface modifications, shared contracts. Use
    FileContentTool to read related files and analyze their dependencies.
  expected_output: >
    An impact assessment with: - Affected components and their criticality -
    Potential breaking changes (with migration steps) - Integration risks (API
    changes, data format changes) - Recommendations for additional testing
  agent: architecture_impact_analyst

architecture_review:
  description: >
    Evaluate architectural implications of commit {commit_sha} in repository
    {repository}.

    Consider: design patterns, SOLID principles, coupling, cohesion,
    scalability, and alignment with existing architecture.

    Reference insights from all previous tasks to provide holistic view.
  expected_output: >
    An architectural assessment with: - Design pattern evaluation
    (appropriate/inappropriate) - Coupling and cohesion analysis - Scalability
    considerations (will this scale?) - Alignment with project architecture
    (consistent/divergent) - Long-term maintainability impact (tech debt
    introduced/reduced)
  agent: architecture_impact_analyst

generate_executive_summary:
  description: >
    === YOUR ROLE: SYNTHESIZER ONLY ===
    
    You are the Executive Summary Agent. Your ONLY job is to read the findings 
    from the 5 previous tasks and write a markdown summary. That's it.
    
    YOU DO NOT HAVE ACCESS TO ANY TOOLS.
    YOU CANNOT call CommitDiffTool, FileContentTool, or any other tool.
    YOU CANNOT fetch data from GitHub.
    YOU CANNOT access the repository.
    
    ALL THE DATA YOU NEED is already in your context from previous tasks:
    - Task 1 (Code Quality): Code review findings
    - Task 2 (Security): Security and performance issues
    - Task 3 (Related Files): List of related files
    - Task 4 (Impact): Impact assessment
    - Task 5 (Architecture): Architecture review
    
    YOUR TASK:
    Read the findings above and synthesize them into ONE cohesive markdown report.
    
    === OUTPUT FORMAT ===
    
    Write markdown with this exact structure:
    
    ```markdown
    ## ðŸ“Š Executive Summary for Commit {commit_sha}
    
    [4-5 sentences: overall assessment, key metrics, recommendation]
    
    **Top 3 Actions:**
    1. [Most important action]
    2. [Second most important action]
    3. [Third most important action]
    
    ---
    
    ## ðŸš¨ Critical Issues (Must Fix Before Merge)
    
    [List critical issues from previous tasks, or "None found" if clean]
    
    ## âš ï¸ Warnings (Should Fix Soon)
    
    [List warnings, or "None found"]
    
    ## ðŸ’¡ Suggestions (Nice to Have)
    
    [List suggestions for improvement]
    
    ## âœ… Positive Observations
    
    [List good patterns found]
    
    ---
    
    **Links:**
    - [View Commit](https://github.com/{repository}/commit/{commit_sha})
    - [View Pull Request](https://github.com/{repository}/pull/{pr_number})
    ```
    
    === IMPORTANT ===
    
    DO NOT try to fetch more data. DO NOT call any tools. DO NOT say "I'll analyze".
    
    Just read your context and write the markdown report NOW.
  expected_output: >
    Complete markdown-formatted executive summary with:
    - Executive summary section (overall assessment, metrics, top 3 actions)
    - Detailed findings by category (critical/warning/suggestion/positive)
    - Code snippets with file:line references where relevant
    - Clear action items for developer
    - Links to commit and PR
    
    The output will be displayed in GitHub Actions summary page and posted as a 
    PR comment.
  agent: executive_summary_agent
